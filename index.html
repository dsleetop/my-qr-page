<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIS 수강신청</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f4; text-align: center; }
        .box { background: white; padding: 25px; border-radius: 15px; display: inline-block; text-align: left; width: 100%; max-width: 350px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        input, textarea { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: #007bff; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        button:disabled { background: #ccc; }
    </style>
</head>
<body>
    <div class="box">
        <h3>GIS수강신청 정보입력</h3>
        <input type="text" id="name" placeholder="이름 (필수)">
        <input type="text" id="dept" placeholder="부서 (필수)">
        <input type="text" id="phone" placeholder="연락처 (필수)">
        <textarea id="notes" placeholder="추가사항"></textarea>
        <button id="submitBtn" onclick="submitData()">등록하기</button>
    </div>

    <script>
        async function submitData() {
            const btn = document.getElementById('submitBtn');
            const url = "https://script.google.com/macros/s/AKfycbyD4hwglv7oYzEH1Yn1ERYSplVDRS41q9fZPrw8mGoGOxWBsLiWkxIwGM0C_bfnJvUSxg/exec"; // <--- 새 배포 URL 확인!

            const data = {
                name: document.getElementById('name').value.trim(),
                dept: document.getElementById('dept').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                notes: document.getElementById('notes').value.trim()
            };

            if(!data.name || !data.dept || !data.phone) {
                alert("항목을 모두 채워주세요.");
                return;
            }

            btn.disabled = true;
            btn.innerText = "전송 중...";

            try {
                // 구글 script와 통신할 때는 'no-cors' 모드가 필요할 수 있습니다.
                await fetch(url, {
                    method: 'POST',
                    mode: 'no-cors', 
                    cache: 'no-cache',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                // no-cors 모드에서는 응답을 읽을 수 없으므로 성공했다고 가정합니다.
                alert("등록이 성공적으로 전송되었습니다!");
                location.reload();

            } catch (error) {
                console.error('Error:', error);
                alert("전송 중 오류가 발생했습니다: " + error.message);
                btn.disabled = false;
                btn.innerText = "등록하기";
            }
        }
    </script>
</body>
</html>